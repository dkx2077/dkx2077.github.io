<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Personal academic homepage for Kaixin Deng" />
    <meta name="author" content="Kaixin Deng" />
    <title id="title">Kaixin Deng's Homepage</title>
    <link rel="icon" type="image/x-icon" href="static/assets/kerisu.ico" />
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KR0MCDLGWW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        // 基础配置 - 针对学术网站优化
        gtag('config', 'G-KR0MCDLGWW', {
            // 隐私设置 
            anonymize_ip: false,
            allow_google_signals: false,
            allow_ad_personalization_signals: false,
            cookie_expires: 365 * 24 * 60 * 60, // Cookie过期时间1年
            cookie_domain: 'auto',
            cookie_flags: 'secure;samesite=lax',
            
            // 增强测量 - 针对学术网站优化
            enhanced_measurements: {
                scrolls: true,
                outbound_clicks: true,
                site_search: false,
                video_engagement: false,
                file_downloads: true,
                page_changes: true
            },
            
            // 统一的自定义参数映射
            custom_map: {
                'custom_parameter_1': 'academic_section',
                'custom_parameter_2': 'visitor_type',
                'custom_parameter_3': 'interaction_depth',
                'custom_parameter_4': 'publication_type',
                'custom_parameter_5': 'engagement_level'
            },
            
            // 会话配置
            session_timeout: 1800, // 30分钟
            
            // 发送页面浏览量
            send_page_view: true,
            
            // 调试模式（生产环境应设为false）
            debug_mode: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
        });
        
        // 设置用户属性
        gtag('set', 'user_properties', {
            'site_type': 'academic_homepage',
            'content_language': 'en',
            'visitor_segment': 'academic_visitor'
        });
        
        // 设置转换事件
        gtag('config', 'G-KR0MCDLGWW', {
            'conversion_events': [
                'publication_click',
                'engagement_milestone',
                'academic_section_view'
            ]
        });
        
        // 错误处理
        window.addEventListener('error', function(e) {
            gtag('event', 'exception', {
                description: e.error ? e.error.toString() : 'Unknown error',
                fatal: false,
                error_source: 'global_handler'
            });
        });
        
        // 设置数据流配置
        gtag('config', 'G-KR0MCDLGWW', {
            'app_name': 'Kaixin Deng Academic Homepage',
            'app_version': '2.0',
            'developer_id': 'dkx2077'
        });
    </script>
    
    <!-- Bootstrap CSS from CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Bootstrap icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    
    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,600;1,600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,300;0,500;0,600;0,700;1,300;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link type="text/css" href="static/css/main.css" rel="stylesheet" />
</head>

<body id="page-top">
    <!-- Navigation -->
    <nav class="header navbar navbar-expand-lg navbar-light fixed-top shadow-sm" id="mainNav">
        <div class="container px-5">
            <a id="page-top-title" class="navbar-brand fw-bold" href="#page-top"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                MENU
                <i class="bi-list"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto me-4 my-3 my-lg-0">
                    <li class="nav-item">
                        <a class="nav-link me-lg-3" href="#page-top">HOME</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link me-lg-3" href="#publications">PUBLICATIONS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link me-lg-3" href="#awards">AWARDS</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link me-lg-3" href="#service">ONGOING WORK</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Top Section -->
    <section class="top-section" style="background-image: url('static/assets/img/background1.png');">
        <div class="top-section-content">
            <div class="container px-1">
                <div class="row">
                    <div class="col-lg-8">
                        <h2 id="top-section-bg-text" class="text-light display-3 lh-1 mb-4 font-alt"></h2>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Home -->
    <section class="bg-gradient-primary-to-secondary-light mt5 md5" id="page-top">
        <div class="container px-5">
            <header>
                <h2 id="home-subtitle"></h2>
            </header>
            <div class="main-body" id="home-md"></div>
        </div>
    </section>

    <!-- Publications -->
    <section class="bg-gradient-primary-to-secondary-gray mt5 md5" id="publications">
        <div class="container px-5">
            <header>
                <h2 id="publications-subtitle"><i class="bi bi-file-text-fill"></i>&nbsp;PUBLICATIONS</h2>
            </header>
            <div class="main-body" id="publications-md"></div>
        </div>
    </section>

    <!-- Awards -->
    <section class="bg-gradient-primary-to-secondary-light mt5 md5" id="awards">
        <div class="container px-5">
            <header>
                <h2 id="awards-subtitle"><i class="bi bi-award-fill"></i>&nbsp;AWARDS</h2>
            </header>
            <div class="main-body" id="awards-md"></div>
        </div>
    </section>

    <!-- Service -->
    <section class="bg-gradient-primary-to-secondary-gray mt5 md5" id="service">
        <div class="container px-5">
            <header>
                <h2 id="service-subtitle"><i class="bi bi-chat-left-text"></i>&nbsp;ONGOING WORK</h2>
            </header>
            <div class="main-body" id="service-md"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-bottom text-center py-5">
        <div class="container px-5">
            <div class="text-white-50 small">
                <div id="copyright-text" class="mb-2">&copy; 2024 Kaixin Deng. All rights reserved.</div>
                <a id="github-link" href="https://github.com/dkx2077/dkx2077.github.io">Github</a>
                <span class="mx-1">&middot;</span>
                <a id="license-link" href="https://github.com/dkx2077/dkx2077.github.io/blob/master/LICENSE">License</a>
            </div>
        </div>
    </footer>

    <!-- Third-party libraries from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    
    <!-- MathJax configuration -->
    <script>
        MathJax = {
            tex: { 
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: true
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

    <!-- Main application script -->
    <!-- GA4集成需要在main.js之前加载 -->
    <script type="module">
        // 预加载GA4集成
        import('./static/js/modules/ga4-integration.js').then(() => {
            console.log('[App] GA4 integration preloaded');
        });
    </script>
    <script type="module" src="static/js/main.js"></script>
    
    <!-- Fallback for older browsers that don't support ES6 modules -->
    <script nomodule src="static/js/scripts.js"></script>
</body>

</html>
